---
title: 事件基本功能封装
date: 2018-03-22 22:02:38
categories: Blogs
tags: [js]
---

前段事件学了[js事件模型系列知识](https://liu97.github.io/2018/03/11/js%E4%BA%8B%E4%BB%B6%E6%A8%A1%E5%9E%8B%E7%B3%BB%E5%88%97%E7%9F%A5%E8%AF%86(%E4%B8%80)%E4%BA%8B%E4%BB%B6%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/),对事件有了一个基本的了解，今天看到一个词汇-封装，于是想起可以封装一个跨浏览器事件对象参照网上的思路。<!--more-->
## 事件对象的封装
由于IE事件和DOM事件对象支持的属性和方法不同，所以封装的时候只考虑IE事件对象和DOM对象共有的属性和方法。接下来就进入正题，将事件的函数和属性按事件模型划分：
```javascript
var eventUtil = {
	//为element添加任意监听事件，参数分别为监听元素，事件类型，监听函数，是否冒泡
	addEvent : function(element,type,handler,isBubble){ 
		if(element.addEventListener){  //支持DOM2事件模型
			element.addEventListener(type,handler,isBubble);
		}
		else if(element.attachEvent){  //支持IE事件模型
			element.attachEvent('on'+type,handler);
		}
		else{  //支持DOM0事件模型
			element['on'+type]=handler;
		}
	},
	//为element解除监听事件，参数与添加监听事件参数相同
	removeEvent : function(element,type,handler,isBubble){
		if(element.removeEventListener){  //支持DOM2事件模型
			element.removeEventListener(type,handler,isBubble);
		}
		else if(element.detachEvent){  //支持IE事件模型
			element.detachEvent('on'+type,handler);
		}
		else{ //支持DOM0事件模型
			element['on'+type]=null;
		}
	},
	//获取事件类型
	getType : function(event){
		return event.type;  
	},
	//获取事件目标函数
	getTarget : function(event){
		return event.target ? event.target : event.srcElement;
	},
	//阻止事件冒泡
	stopProPagation :function(event){
		if(event.stopProPagation){
          	event.stopProPagation();
   	   	}else{
   	   	  	event.cancelBubble = true;
   	   	}
	},
	//阻止事件默认行为
	preventDefault : function(event){
		if(event.preventDefault){
			event.preventDefault();
		}
		else
		{
			event.returnValue = false;
		}
	}       		
}
```
## 事件对象的使用
基本使用方法如下：
```javascript
let handler = function(event){
	console.log(eventUtil.getType(event)); //输出事件类型
	console.log(eventUtil.getTarget(event)); //输出事件目标
}
eventUtil.addEvent(box,"click",handler,true); //为box添加点击事件监听
eventUtil.removeEvent(box,"click",handler,true); //为box解除点击事件监听
eventUtil.stopProPagation(event); //为event阻止冒泡
eventUtil.preventDefault(event); //为event阻止默认事件
```

## 感谢链接
[添加和移除事件处理兼容各浏览器的封装（带详细注释）](https://blog.csdn.net/topwqp/article/details/41731115)